# 构建镜像（在 backend 目录下运行）
docker build -t chat-backend -f docker/Dockerfile .

# 使用 docker-compose 运行（在 backend 目录下运行）
docker-compose -f docker/docker-compose.yml up

# 或者使用 docker run 运行容器（在 backend 目录下运行）
docker run -p 8000:8000 \
  --env-file .env \
  -v $(pwd):/app \
  chat-backend

# 本地开发运行
uvicorn main:app --host 0.0.0.0 --port 8000 --reload

# 构建特定版本
docker build -t chat-backend:latest -f docker/Dockerfile .   

#本地测试
docker run -p 8000:8000 --env-file /Users/feiwang/Desktop/projects/chat_new_2024_12/.env -v $(pwd):/app chat-backend

# AWS ECR 登录
aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin 851725188914.dkr.ecr.us-east-1.amazonaws.com

# 标记镜像
docker tag chat-backend:latest 851725188914.dkr.ecr.us-east-1.amazonaws.com/chat_app_backend:latest

# 推送镜像
docker push 851725188914.dkr.ecr.us-east-1.amazonaws.com/chat_app_backend:latest 

# 其他命令
brew install rust
source backend_venv/bin/activate